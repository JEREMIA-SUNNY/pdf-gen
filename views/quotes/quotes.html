<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Quotation PDF</title>
    <!-- Import Noto Sans font from Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
      @page {
        size: A4;
        margin: 100px 50px 90px 50px; /* Increased bottom margin for footer space */
        @bottom-left {
          margin-top: 10px;
          content: "N.K.RF Products & Services Private Limited\A#2, 2nd Cross, Rustam Bagh Layout, Bangalore -560017\APhone: +91-80-25281840 | Email: reachus@nkegroup.com";
          font-size: 8px;
          white-space: pre;
          line-height: 15px;
        }
        @bottom-right {
          content: counter(page) "/" counter(pages);
          font-size: 8px;
        }
      }
      
      /* Global styling for main content - BUT not applying to TC section */
      body,
      p,
      div:not(.tc-content *):not(.special-conditions *),
      table:not(.tc-content table),
      span:not(.tc-content span),
      td:not(.tc-content td),
      th:not(.tc-content th),
      li:not(.tc-content li),
      .special-conditions,
      .special-conditions h2,
      .special-conditions div {
        font-family: "Noto Sans", "DejaVu Sans", sans-serif;
        font-size: 12px;
      }

      /* Reset margins and padding globally */
      * {
        font-family: "Noto Sans", "DejaVu Sans", sans-serif;
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      /* Special class for terms and conditions content */
      .tc-content * {
        font-size: 8px !important;
        font-family: "Noto Sans", "DejaVu Sans", sans-serif;
      }

      img,
      div,
      table,
      span {
        min-height: 10px;
      }
      
      .header {
        border-bottom: 1px solid gray;
        display: flex;
        position: fixed;
        align-items: flex-end;
        justify-content: space-between;
        left: 0px; /* Match the page margin */
        right: 0px; /* Match the page margin */
        top: -100px;
        height: 75px;
        padding: 10px 0;
        min-height: 1px;
        background-color: white; /* Ensure header is visible */
      }
      
      .header > .title {
        display: flex;
        align-items: flex-end;
        font-size: 20px;
        font-weight: bold;
        color: #375fbd;
      }
      
      .header > .logo {
        width: 100px;
      }
      
      body {
        font-family: "Noto Sans", "DejaVu Sans", sans-serif;
        margin: 0;
        line-height: 1.5;
        color: #000;
      }
      
      p {
        margin: 0 0 8px 0;
      }
      
      .to-block p {
        margin: 0;
        line-height: 1.2;
        padding: 0;
      }
      
      h2 {
        margin: 0;
        padding: 4px 0;
        text-align: center;
      }
      
      table {
        border-collapse: collapse;
        width: 100%;
        margin-bottom: 1em;
        table-layout: fixed;
      }
      
      table,
      th,
      td {
        border: 1px solid #23272e;
        padding: 5px;
      }
      
      .quotation-table th {
        background: #f2f2f2;
      }

      /* Fixed column widths for quotation table */
      .quotation-table th:nth-child(1) {
        width: 40px;
      }
      
      .quotation-table th.customer-part {
        width: 100px;
      }
      
      .quotation-table th.nkrf-part {
        width: 110px;
      }
      
      .quotation-table th.description {
        width: 170px;
      }
      
      .quotation-table th.moq {
        width: 50px;
      }
      
      .quotation-table th.unit-price {
        width: 70px;
      }
      
      /* Increased width for extended price column */
      .quotation-table th.ext-price {
        width: 120px;
      }

      /* Force text wrapping in description cell */
      .quotation-table td {
        word-wrap: break-word;
        overflow-wrap: break-word;
        hyphens: auto;
        vertical-align: middle;
        font-size: 11px;
      }

      /* Prevent price from wrapping */
      .quotation-table td.price-cell {
        white-space: nowrap;
        text-align: right;
      }

      /* Ensure column headers use the same font size */
      .quotation-table th {
        font-size: 11px;
        font-weight: bold;
      }

      /* NEW: Keep summary rows together */
      .quotation-summary {
        page-break-inside: avoid;
        break-inside: avoid;
      }

      .tc-table {
        margin-top: 0;
      }
      
      .tc-table td.heading {
        font-size: 12px;
        width: 220px;
        background: #ffff;
        font-weight: bold;
        text-align: center;
        vertical-align: middle;
        color: #375fbd;
      }
      
      .tc-table td.content {
        vertical-align: top;
        font-size: 12px;
      }
      
      .address-table {
        border-collapse: collapse;
        width: 100%;
        margin-bottom: 1.5em;
      }
      
      .address-table th,
      .address-table td {
        border: 1px solid #23272e;
        padding: 6px 8px;
        text-align: left;
        vertical-align: top;
        font-size: 12px;
      }
      
      .address-table th {
        background: #f2f2f2;
        font-weight: bold;
      }
      
      .address-table td {
        width: 50%;
      }
      
      .details-list {
        margin-left: 0;
        padding-left: 1.2em;
        margin-bottom: 1.5em;
      }
      
      .details-list li {
        margin-bottom: 0.5em;
      }
      
      .special-conditions {
        margin-bottom: 1.5em;
        text-align: left;
        font-size: 12px !important;
        padding-left: 0;
        margin-left: 0;
      }

      .special-conditions h2 {
        text-align: left;
        margin-left: 0;
        font-size: 12px !important;
      }

      .special-conditions div {
        text-align: left;
        margin-bottom: 0.5em;
        font-size: 12px !important;
        margin-left: 0;
        padding-left: 0;
      }

      .bold-text {
        font-weight: 600; /* Medium weight instead of bold */
      }

      /* Add this to your existing CSS styles */
      strong, b {
        font-weight: 500; /* Reduce from default bold (700) to medium (500) */
      }

      /* Ensure consistent font weight for specific elements */
      .to-block strong,
      .section-title,
      p strong {
        font-weight: 500;
      }
      
      /* NEW: Prevent page break inside important sections */
      .keep-together {
        page-break-inside: avoid;
        break-inside: avoid;
      }
      
      /* NEW: Force page break before T&C section if needed */
      .tc-content {
        page-break-before: auto;
      }
    </style>
  </head>

  <body>
    <!-- Fixed header that will appear on every page -->
    <div class="header">
      <p class="title">Quotation</p>
      <img
        class="logo"
        src="https://cmpl.nkegroup.com/_next/image?url=%2FdataSheetLogo.png&w=384&q=75"
      />
    </div>

    <p><span class="bold-text">Quotation Reference: {{ data.quotationRef }}</span></p>
    <p><span class="bold-text">Enquiry Number: {{ data.enquiryNumber }}</span></p>
    <p>Date: {{ data.quoteDate }}</p>
    <br />

    <div class="to-block">
      <p>To,</p>
      <p><span class="bold-text">{{ data.customerName }}</span></p>
      <p>{{ data.billingAddress.line1 }}</p>
      <p>{{ data.billingAddress.line2 }}</p>
      <p>
        {{ data.billingAddress.state }}, {{ data.billingAddress.city }} – {{
        data.billingAddress.pinCode }}
      </p>
      <p>GST No: {{ data.customerGst }}</p>
    </div>

    <br /><br />
    <div class="to-block">
      <p class="section-title">
      <span class="bold-text">Kind Attention: {{ data.contactName }}</span>
    </p>
    <span>{{ data.contactEmail }}</span><br />
    <span>{{ data.contactMobile }}</span>
      </div>

    <br /><br />

    <p class="section-title">Subject: {{ data.subTitle }}</p>

    {% if data.contactSalutation|lower == "mr" %} {% set greeting = "sir" %} {%
    elif data.contactSalutation|lower in ["mrs", "ms", "mx"] %} {% set greeting
    = "ma'am" %} {% else %} {% set greeting = "sir/madam" %} {% endif %}
    <p>Dear {{ greeting }},</p>

    <p>
      NKRF is a <span class="bold-text">full-stack harness manufacturer</span> with capabilities to
      support any interconnecting harnesses in
      <span class="bold-text">RF, copper, &amp; fiber optics</span>. Our capabilities in copper extend
      to power, control &amp; signal with connector types ranging across
      circular D38999 connectors, D-sub, micro-D, nano-D, USB, RJ45 (Ethernet).
      In <span class="bold-text">fiber</span>, we support standard optical connectors as well as
      <span class="bold-text">termini used in military applications</span>. NKRF also supports machined
      components per customer spec.
    </p>

    <p>
      NKRF is also proud to share that we have been awarded
      <span class="bold-text">"Certificate for Qualification – For Space Use"</span> from ISRO, thus
      becoming the 1st and only indigenous vendor to be qualified for supply of
      RF &amp; MW cable assemblies for space missions. NKRF is also proud to
      have supplied RF Cables which are currently flying on satellites on ESA
      approved missions.
    </p>

    <p>
      NKRF is an AS9100 Rev D Certified company and its
      <span class="bold-text">RF Cable Assemblies are CEMILAC qualified for airborne applications</span>
      on fixed and rotary wing aircraft.
    </p>

    <p>
      NKRF is an MSME registered with NSIC, a woman entrepreneur-run business
      supporting the "Make In India" initiative.
    </p>

    <p>
      NKRF offer Coaxial cables with the lowest loss in the industry for
      comparable cables and are available with a variety of shielded and
      external jacketed options for use in hostile environment with extreme
      temperature, abrasion, crush resistant, high-pressure fluids, vibration
      and mechanical stress to name a few.
    </p>

    <p>
      In line with your requirements and the technical compliance statement
      submitted to you, we are enclosing our budgetary quote against your
      requirement. Please feel free to contact us for any clarification.
    </p>
    <br /><br />
    <p>Yours Sincerely,</p>
    <img src="{{ data.signImage }}" alt="Signature" style="width: 150px" />
    <p>For N.K. RF Products &amp; Services Pvt. Ltd,</p>
    <p><span class="bold-text">Alok Sood</span></p>

    <br /><br /><br /><br />
    
    <!-- Quotation Table with improved page break handling -->
    <div style="page-break-before: always">
      {% set partsWithCustomer = data.parts | selectattr("customerPartNumber", "ne", "") | list %}
      {% set showCustomerPart = partsWithCustomer | length > 0 %}
      <table class="quotation-table">
        <thead>
          <tr>
            <th style="text-align: center; vertical-align: middle; width: 40px;">Sr. No.</th>
            {% if showCustomerPart %}
            <th style="text-align: center; vertical-align: middle; width: 100px;">Customer Part No.</th>
            {% endif %}
            <th style="text-align: center; vertical-align: middle; width: 150px;">NKRF Part No.</th>
            <th style="text-align: center; vertical-align: middle; width: auto;">Description</th>
            <th style="text-align: center; vertical-align: middle; width: 50px;">MOQ</th>
            <th style="text-align: center; vertical-align: middle; width: 90px;">Unit Price</th>
            <!-- Increased width for extended price -->
            <th style="text-align: center; vertical-align: middle; width: 120px;">
              {% if data.isGstInclusive %}
              Extended Price<br />(incl. GST)
              {% else %}
              Extended Price<br />(excl. GST)
              {% endif %}
            </th>
          </tr>
        </thead>
        <tbody>
          {% for item in data.parts %}
          <tr>
            <td style="text-align: center; vertical-align: middle;">{{ item.slNo }}</td>
            {% if showCustomerPart %}
            <td style="text-align: center; vertical-align: middle;">{{ item.customerPartNumber }}</td>
            {% endif %}
            <td style="text-align: center; vertical-align: middle;">{{ item.NKRFPartNumber }}</td>
            <td style="vertical-align: middle;">
              {{ item.NKRFPartDescription }}
              {% if item.phaseMatch %}
                <br>
                <span style="text-decoration: underline; font-size: 11px;">
                  {{ item.phaseMatch.split('x')[0]|trim }} pc(s) x {{ item.phaseMatch.split('x')[1]|trim }} set(s)
                </span>
              {% endif %}
            </td>
            <td style="text-align: center; vertical-align: middle;">{{ item.moq }}</td>
            <!-- Added price-cell class to prevent wrapping -->
            <td style="text-align: right; vertical-align: middle; white-space: nowrap;">
              {{ item.unitPriceFormatted }}
            </td>
            <!-- Added price-cell class to prevent wrapping -->
            <td style="text-align: right; vertical-align: middle; white-space: nowrap;">
              {{ item.extendedPriceFormatted }}
            </td>
          </tr>
          {% endfor %}
        </tbody>
        
        <!-- Summary section - kept together -->
        <tbody class="quotation-summary">
          <tr>
            <td colspan="{% if showCustomerPart %}6{% else %}5{% endif %}" style="text-align: right; vertical-align: middle;">
              <strong>Sub Total:</strong>
            </td>
            <td style="text-align: right; vertical-align: middle; white-space: nowrap;">
              {{ data.subtotal}}
            </td>
          </tr>
          <tr>
            <td colspan="{% if showCustomerPart %}6{% else %}5{% endif %}" style="text-align: right; vertical-align: middle;">
              <strong>Discount:</strong>
            </td>
            <td style="text-align: right; vertical-align: middle; white-space: nowrap;">
              {{ data.discountAmount }}
            </td>
          </tr>
          <tr>
            <td colspan="{% if showCustomerPart %}6{% else %}5{% endif %}" style="text-align: right; vertical-align: middle;">
              <strong>Rounding Off:</strong>
            </td>
            <td style="text-align: right; vertical-align: middle; white-space: nowrap;">
              {{ data.roundingAdjustment }}
            </td>
          </tr>
          <tr>
            <td colspan="{% if showCustomerPart %}6{% else %}5{% endif %}" style="text-align: right; vertical-align: middle;">
              <strong>Total Amount:</strong>
            </td>
            <td style="text-align: right; vertical-align: middle; white-space: nowrap;">
              {{ data.totalAmount }}
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Include Additional Details from a separate file -->
    <div class="keep-together">
      {% include "quotes/totalamount.html" %}
    </div>

    <!-- Include T&C using a separate partial with small font -->
    <div class="tc-content">
      {%- include "quotes/termsAndCondition.html" -%}
    </div>

    <br />
  </body>
</html>